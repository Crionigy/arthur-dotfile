function syncInterface(e){let t={};if("default"===e)t={enableRulesetIds:[],disableRulesetIds:["ruleset_1","ruleset_2","ruleset_3","ruleset_4","ruleset_5","ruleset_6"]},chrome.scripting.getRegisteredContentScripts().then(e=>{for(var t=0;t<e.length;t++)if("script5"===e[t].id){chrome.scripting.unregisterContentScripts({ids:["script5"]});break}for(t=0;t<e.length;t++)if("script6"===e[t].id){chrome.scripting.unregisterContentScripts({ids:["script6"]});break}});else if("sh"===e)t={enableRulesetIds:["ruleset_1","ruleset_2","ruleset_3"],disableRulesetIds:["ruleset_4","ruleset_5","ruleset_6"]},chrome.scripting.getRegisteredContentScripts().then(e=>{for(var t=0;t<e.length;t++)if("script5"===e[t].id){chrome.scripting.unregisterContentScripts({ids:["script5"]});break}for(t=0;t<e.length;t++)if("script6"===e[t].id){chrome.scripting.unregisterContentScripts({ids:["script6"]});break}});else if("new"===e){let r=!(t={enableRulesetIds:[],disableRulesetIds:["ruleset_1","ruleset_2","ruleset_3","ruleset_4","ruleset_5","ruleset_6"]}),s=!1;chrome.scripting.getRegisteredContentScripts().then(e=>{for(var t=0;t<e.length;t++)if("script5"===e[t].id){r=!0;break}for(t=0;t<e.length;t++)if("script6"===e[t].id){s=!0;break}}),!1===r&&chrome.scripting.registerContentScripts([{id:"script5",matches:["*://www.reddit.com/web/r/uichangerforreddit/submit"],runAt:"document_start",js:["content_secondgen.js"]}]),!1===s&&chrome.scripting.registerContentScripts([{id:"script6",matches:["*://www.reddit.com/*"],excludeMatches:["*://*/web/r/uichangerforreddit/submit"],runAt:"document_start",js:["content_gateway.js"]}])}else"old"===e&&(t={enableRulesetIds:["ruleset_4","ruleset_5","ruleset_6"],disableRulesetIds:["ruleset_1","ruleset_2","ruleset_3"]},chrome.scripting.getRegisteredContentScripts().then(e=>{for(var t=0;t<e.length;t++)if("script5"===e[t].id){chrome.scripting.unregisterContentScripts({ids:["script5"]});break}for(t=0;t<e.length;t++)if("script6"===e[t].id){chrome.scripting.unregisterContentScripts({ids:["script6"]});break}}));chrome.declarativeNetRequest.updateEnabledRulesets(t).then(()=>{chrome.tabs.reload().then(()=>{})})}function syncRawImage(e){var t={enableRulesetIds:[],disableRulesetIds:[]};(!0===e?t.enableRulesetIds:t.disableRulesetIds).push("ruleset_7"),chrome.declarativeNetRequest.updateEnabledRulesets(t).then(()=>{chrome.tabs.reload().then(()=>{})})}chrome.runtime.onInstalled.addListener(e=>{"install"===e.reason?(chrome.tabs.create({url:"install/install.html"}),chrome.storage.local.set({interface:"default",cardColor:"#fafafb",hyperlinkColor:"#115bca",customCardColor:!1,customHyperlinkColor:!1,rawImage:!1,removeSidebar:!1}),syncInterface("default"),syncRawImage(!1)):"update"===e.reason&&(chrome.tabs.create({url:"update/update.html"}),chrome.storage.local.get(["interface","rawImage","removeSidebar"]).then(e=>{syncInterface(e.interface),syncRawImage(e.rawImage),!0===e.removeSidebar&&chrome.scripting.registerContentScripts([{id:"script1",js:["content_sidebar.js"],matches:["*://*.reddit.com/*"]}])}))}),chrome.runtime.onStartup.addListener(function(){chrome.storage.local.get(["interface","rawImage"]).then(e=>{syncPreferences(e.interface,e.rawImage)})}),chrome.storage.onChanged.addListener((e,t)=>{e.removeSidebar&&(!0===e.removeSidebar.newValue?chrome.scripting.registerContentScripts([{id:"script1",js:["content_sidebar.js"],matches:["*://*.reddit.com/*"]}]):chrome.scripting.getRegisteredContentScripts().then(e=>{for(var t=0;t<e.length;t++)if("script1"===e[t].id){chrome.scripting.unregisterContentScripts({ids:["script1"]});break}})),e.customCardColor&&(!0===e.customCardColor.newValue?chrome.scripting.registerContentScripts([{id:"script3",js:["content_card.js"],matches:["*://*.reddit.com/*"]}]):chrome.scripting.getRegisteredContentScripts().then(e=>{for(var t=0;t<e.length;t++)if("script3"===e[t].id){chrome.scripting.unregisterContentScripts({ids:["script3"]});break}})),e.customHyperlinkColor&&(!0===e.customHyperlinkColor.newValue?chrome.scripting.registerContentScripts([{id:"script4",js:["content_hyperlink.js"],matches:["*://*.reddit.com/*"]}]):chrome.scripting.getRegisteredContentScripts().then(e=>{for(var t=0;t<e.length;t++)if("script4"===e[t].id){chrome.scripting.unregisterContentScripts({ids:["script4"]});break}})),e.interface&&syncInterface(e.interface.newValue),e.rawImage&&syncRawImage(e.rawImage.newValue)});
